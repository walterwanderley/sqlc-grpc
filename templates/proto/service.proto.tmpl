syntax = "proto3";

package {{.Package | SnakeCase}}.v1;

import "google/api/annotations.proto";
import "protoc-gen-openapiv2/options/annotations.proto";
{{range .ProtoImports}}{{ .}}
{{end}}
{{if .CustomProtoOptions}}{{range .CustomProtoOptions}}{{ .}}
{{end}}{{else}}option go_package = "{{.GoModule}}/api/{{.Package | SnakeCase}}/v1";
option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_swagger) = {
    info: {
        title: "{{.GoModule}}";
        version: "1.0";
        description: "Boilerplate code generated by **sqlc-grpc**. Modify _proto/*.proto_ files then run `buf generate` to change the services interface.";
        contact: {
            name: "sqlc-grpc";
            url: "https://github.com/walterwanderley/sqlc-grpc";
        };
    };
};{{end}}
{{range .CustomServiceProtoComments}}// {{ .}}
{{end -}}
service {{.Package | PascalCase}}Service {
    {{range .CustomServiceProtoOptions}}{{ .}}
    {{end}}
    {{- range .CustomProtoRPCs}}{{ .}}
    {{end}}
    {{- range .Services}}{{if not .Skip}}
    {{range .CustomProtoComments}}// {{ .}}
    {{end -}}
    rpc {{.Name | UpperFirstCharacter}}({{.Name | UpperFirstCharacter}}Request) returns ({{.Name | UpperFirstCharacter}}Response) {
        {{range .HttpOptions}}{{ .}}
        {{end}}
    }{{end}}{{end}}
}

{{- range .CustomProtoMessages}}{{ .}}
{{end}}

{{range $key, $value := .Messages}}
{{range $value.CustomProtoComments}}// {{ .}}
{{end -}}
message {{$value.ProtoName | UpperFirstCharacter}} {
{{range $value.CustomProtoOptions}}{{ .}}
{{end -}}
{{$value.ProtoAttributes -}}
}
{{end}}
{{if .HasExecResult}}
message ExecResult {
    int64 rowsAffected = 1;
    int64 lastInsertId = 2;
}
{{end}}